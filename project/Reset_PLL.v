// ============================================================================
// 模块名称: Reset_PLL
// 功能描述: 检测低电平复位脉冲，产生10us高电平复位信号
// 版本: Quartus 13.0 + Cyclone IV兼容（移除SystemVerilog语法）
// ============================================================================

module Reset_PLL (
    input  clk_50M,    // 50MHz时钟输入
    input  reset_n,    // 低电平复位触发脉冲
    output areset      // 高电平复位输出
);
    // 参数定义
    parameter COUNT_MAX = 9'd499;          // 9位计数器，最大值499
    parameter COUNT_WIDTH = 9;

    // 内部寄存器
    reg [COUNT_WIDTH-1:0] count;           // 9位递减计数器
    reg in_reset;
    // 复位状态标志
    reg sync_reset_n_r1, sync_reset_n_r2;  // 同步寄存器

    // ============================================================================
    // 1. 同步复位信号（两级同步，防止亚稳态）
    // ============================================================================
    always @(posedge clk_50M) begin
        sync_reset_n_r1 <= reset_n;
        sync_reset_n_r2 <= sync_reset_n_r1;
    end

    // ============================================================================
    // 2. 检测下降沿（同步后的reset_n从高变低）
    // ============================================================================
    wire reset_trigger = sync_reset_n_r2 & ~sync_reset_n_r1;
    // ============================================================================
    // 3. 主状态逻辑
    // ============================================================================
    always @(posedge clk_50M) begin
        if (reset_trigger) begin
            // 检测到复位触发，开始10us复位
            in_reset <= 1'b1;
            count <= COUNT_MAX;            // 加载计数值
        end else if (in_reset) begin
            // 复位进行中，计数器递减
            if (count == 0)
                in_reset <= 1'b0;
            // 计数结束，释放复位
            else
                count <= count - 1'b1;
            // 修正：使用verilog-2001语法
        end
    end

    // ============================================================================
    // 4. 输出赋值
    // ============================================================================
    assign areset = in_reset;

endmodule
